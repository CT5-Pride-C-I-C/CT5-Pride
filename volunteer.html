<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Security Meta Tags -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    
    <link rel="icon" type="image/svg+xml" href="Images/Logo-with-Transparent-background.svg">
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <title>Volunteer Opportunities - CT5 Pride</title>
    <meta name="description" content="Volunteer with CT5 Pride and help create inclusive events and support for the LGBTQ+ community in Whitstable.">
    
    <!-- OpenGraph/Social Media Meta Tags -->
    <meta property="og:title" content="Volunteer Opportunities - CT5 Pride">
    <meta property="og:description" content="Volunteer with CT5 Pride and help create inclusive events and support for the LGBTQ+ community in Whitstable.">
    <meta property="og:image" content="https://ct5pride.org.uk/Images/Logo-with-Transparent-background.svg">
    <meta property="og:url" content="https://ct5pride.org.uk/volunteer.html">
    <meta property="og:type" content="website">
</head>
<body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Progress Pride Flag Stripe -->
    <div class="pride-stripe" role="banner" aria-label="Progress Pride Flag"></div>
    
    <header>
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo-link" aria-label="CT5 Pride Homepage">
                    <img src="Images/Logo-with-Transparent-background.svg" alt="CT5 Pride logo" class="site-logo">
                </a>
                
                <button class="nav-toggle" aria-label="Toggle navigation menu" aria-expanded="false">
                    ‚ò∞
                </button>
                
                <nav role="navigation" aria-label="Main navigation">
                    <ul>
                        <li><a href="index.html" >Home</a></li>
                        <li class="dropdown">
                            <a href="#" aria-haspopup="true" aria-expanded="false">About</a>
                            <ul class="dropdown-content" role="menu">
                                <li role="none"><a href="about.html" role="menuitem">About Us</a></li>
                                <li role="none"><a href="team.html" role="menuitem">Our Team</a></li>
                            </ul>
                        </li>
                        <li><a href="events.html">Events</a></li>
                        <li class="dropdown">
                            <a href="#" aria-haspopup="true" aria-expanded="false">Get Involved</a>
                            <ul class="dropdown-content" role="menu">
                                <li role="none"><a href="get-involved.html" role="menuitem">Overview</a></li>
                                <li role="none"><a href="volunteer.html" role="menuitem" aria-current="page">Volunteer Opportunities</a></li>
        
                                <li role="none"><a href="contact.html" role="menuitem">Contact Us</a></li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" aria-haspopup="true" aria-expanded="false">Support & Education</a>
                            <ul class="dropdown-content" role="menu">
                                <li role="none"><a href="help-support.html" role="menuitem">Help & Support</a></li>
                                <li role="none"><a href="education.html" role="menuitem">Education Resources</a></li>
                                <li role="none"><a href="pride-quiz.html" role="menuitem">Pride Knowledge Quiz</a></li>
                            </ul>
                        </li>
                        <li class="donate-button">
                            <a href="https://www.justgiving.com/crowdfunding/ct5pride" target="_blank" rel="noopener noreferrer" class="donate-link">
                                üíù Donate
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <main id="main-content">
        <!-- Enhanced Volunteer Hero Section -->
        <section class="hero decorative-shapes" style="background: var(--cosmic-gradient); padding: 4rem 0; position: relative;">
            <!-- IDEOGRAM GRAPHIC ACTIVE: volunteer_community_background.svg background -->
            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('Images/volunteer_community_background.svg') center/cover no-repeat; opacity: 0.2; z-index: 1;"></div>
            <div class="container" style="position: relative; z-index: 2;">
                <div style="text-align: center; color: white; max-width: 800px; margin: 0 auto;">
                    <h1 style="font-size: 3.5rem; margin-bottom: 2rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                        ü§ù Volunteer With Us
                    </h1>
                    <p style="font-size: 1.4rem; line-height: 1.8; text-shadow: 1px 1px 2px rgba(0,0,0,0.2);">
                        Join our passionate team of volunteers and help create meaningful change in the LGBTQIA+ 
                        community. Every skill, every hour, and every heart makes a difference.
                    </p>
                </div>
            </div>
        </section>

        <!-- Vibrant Section Divider -->
        <div class="section-divider" role="separator" aria-hidden="true"></div>

        <!-- Enhanced Why Volunteer Section -->
        <section class="decorative-shapes" style="background: var(--pastel-gradient); padding: 4rem 0;">
            <div class="container">
                <h2 style="text-align: center; font-size: 2.5rem; margin-bottom: 3rem; color: var(--text); text-shadow: 2px 2px 4px rgba(0,0,0,0.1);">
                    ‚ú® Why Volunteer with CT5 Pride?
                </h2>
                <div class="cta-grid">
                    <div style="background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,240,245,0.95) 100%); padding: 3rem; border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); border-top: 6px solid var(--rainbow-gradient); text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üíù</div>
                        <h3 style="color: var(--primary); font-size: 1.5rem; margin-bottom: 1rem; font-weight: 700;">Make a Real Impact</h3>
                        <p style="font-size: 1.1rem; color: var(--text); line-height: 1.6;">
                            Your contributions directly support LGBTQIA+ individuals and help build a more 
                            inclusive community where everyone can thrive.
                        </p>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(240,255,255,0.95) 100%); padding: 3rem; border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); border-top: 6px solid var(--warm-gradient); text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üåü</div>
                        <h3 style="color: var(--primary); font-size: 1.5rem; margin-bottom: 1rem; font-weight: 700;">Develop New Skills</h3>
                        <p style="font-size: 1.1rem; color: var(--text); line-height: 1.6;">
                            Gain valuable experience in event planning, community outreach, marketing, 
                            and leadership while working alongside passionate team members.
                        </p>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,250,250,0.95) 100%); padding: 3rem; border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); border-top: 6px solid var(--pastel-gradient); text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ü§ó</div>
                        <h3 style="color: var(--primary); font-size: 1.5rem; margin-bottom: 1rem; font-weight: 700;">Build Lasting Friendships</h3>
                        <p style="font-size: 1.1rem; color: var(--text); line-height: 1.6;">
                            Connect with like-minded individuals who share your passion for equality, 
                            community building, and creating positive change.
                        </p>
                    </div>

                    <div style="background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,224,0.95) 100%); padding: 3rem; border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); border-top: 6px solid #ffe066; text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üé´</div>
                        <h3 style="color: var(--primary); font-size: 1.5rem; margin-bottom: 1rem; font-weight: 700;">Free CT5 Pride Membership</h3>
                        <p style="font-size: 1.1rem; color: var(--text); line-height: 1.6;">
                            All volunteers receive free membership to CT5 Pride, giving you access to member-only events, updates, and more.
                        </p>
                    </div>

                    <div style="background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(230,245,255,0.95) 100%); padding: 3rem; border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); border-top: 6px solid #6ec6ff; text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üõçÔ∏è</div>
                        <h3 style="color: var(--primary); font-size: 1.5rem; margin-bottom: 1rem; font-weight: 700;">Access to Exclusive Merch</h3>
                        <p style="font-size: 1.1rem; color: var(--text); line-height: 1.6;">
                            Volunteers get early access and special discounts on exclusive CT5 Pride merchandise and swag.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Vibrant Section Divider -->
        <div class="section-divider" role="separator" aria-hidden="true"></div>

        <!-- Enhanced Volunteer Opportunities Section -->
        <section id="volunteer-roles" class="decorative-shapes" style="padding: 4rem 0; background: rgba(255,255,255,0.95);">
            <!-- IDEOGRAM GRAPHIC ACTIVE: volunteer_community_background.svg is displaying via CSS .role-board::before -->
            <div class="container">
                <h2 style="text-align: center; font-size: 2.5rem; margin-bottom: 3rem; color: var(--text); text-shadow: 2px 2px 4px rgba(0,0,0,0.1);">
                    üåà Current Volunteer Opportunities
                </h2>
                <div class="role-board" id="role-board">
                    <!-- Volunteer roles will be dynamically loaded here -->
                </div>
            </div>
        </section>

        <!-- Vibrant Section Divider -->
        <div class="section-divider" role="separator" aria-hidden="true"></div>

        <!-- Enhanced Getting Started Section -->
        <section class="decorative-shapes" style="background: var(--cosmic-gradient); padding: 4rem 0;">
            <div class="container">
                <div style="max-width: 800px; margin: 0 auto; text-align: center;">
                    <h2 style="font-size: 2.5rem; margin-bottom: 2rem; color: white; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                        üöÄ Ready to Get Started?
                    </h2>
                    <div style="background: rgba(255,255,255,0.95); padding: 3rem; border-radius: 20px; backdrop-filter: blur(10px); border: 2px solid rgba(255,255,255,0.3); margin-bottom: 2rem; box-shadow: 0 15px 40px rgba(0,0,0,0.2);">
                        <p style="font-size: 1.3rem; line-height: 1.8; margin-bottom: 2rem; color: var(--text); text-shadow: none;">
                            Getting involved is easy! Simply click on any role that interests you to learn more 
                            and submit an application. We'll be in touch within a few days to discuss next steps.
                        </p>
                        <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                            <a href="contact.html" class="button" style="background: var(--accent); color: white; border: 3px solid var(--accent); font-size: 1.1rem; padding: 1rem 2rem;">
                                Have Questions?
                            </a>
                            <a href="about.html" class="button secondary" style="font-size: 1.1rem; padding: 1rem 2rem;">
                                Learn About Us
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Enhanced Accessibility Panel -->
    <div class="accessibility-panel">
        <button class="accessibility-toggle" aria-label="Open accessibility options" aria-expanded="false">
            ‚ôø
        </button>
        <div class="accessibility-menu" role="dialog" aria-labelledby="accessibility-title">
            <h3 id="accessibility-title">Accessibility Options</h3>
            
            <div class="accessibility-option">
                <label for="high-contrast-toggle">High Contrast Mode</label>
                <div class="accessibility-toggle-switch" 
                     id="high-contrast-toggle"
                     role="switch" 
                     aria-checked="false" 
                     tabindex="0"
                     data-setting="high-contrast">
                </div>

    <script src="js/main.js"></script>
    
    <!-- Application Modal JavaScript -->
    <script>
        // Global variables for application modal
        let currentRoleId = null;
        let currentRoleTitle = null;

        // Function to open application modal
        function openApplicationModal(roleId, roleTitle) {
            currentRoleId = roleId;
            currentRoleTitle = roleTitle;
            
            // Set modal title and hidden fields
            document.getElementById('applicationModalTitle').textContent = `Apply for: ${roleTitle}`;
            document.getElementById('roleId').value = roleId;
            document.getElementById('roleTitle').value = roleTitle;
            
            // Show modal
            document.getElementById('applicationModal').style.display = 'flex';
            
            // Focus on first input for accessibility
            setTimeout(() => {
                document.getElementById('applicantName').focus();
            }, 100);
            
            // Add escape key handler
            document.addEventListener('keydown', handleApplicationEscape);
        }

        // Function to close application modal
        function closeApplicationModal() {
            document.getElementById('applicationModal').style.display = 'none';
            document.getElementById('applicationForm').reset();
            
            // Hide all conditional form groups
            document.getElementById('cvFileGroup').style.display = 'none';
            document.getElementById('cvTextGroup').style.display = 'none';
            document.getElementById('coverLetterFileGroup').style.display = 'none';
            document.getElementById('coverLetterTextGroup').style.display = 'none';
            
            // Remove escape key handler
            document.removeEventListener('keydown', handleApplicationEscape);
        }

        // Handle escape key for application modal
        function handleApplicationEscape(e) {
            if (e.key === 'Escape') {
                closeApplicationModal();
            }
        }

        // Handle CV type selection
        document.addEventListener('DOMContentLoaded', function() {
            // CV type radio buttons
            document.querySelectorAll('input[name="cvType"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const cvFileGroup = document.getElementById('cvFileGroup');
                    const cvTextGroup = document.getElementById('cvTextGroup');
                    
                    if (this.value === 'file') {
                        cvFileGroup.style.display = 'block';
                        cvTextGroup.style.display = 'none';
                        document.getElementById('cvText').removeAttribute('required');
                        document.getElementById('cvFile').setAttribute('required', 'required');
                    } else {
                        cvFileGroup.style.display = 'none';
                        cvTextGroup.style.display = 'block';
                        document.getElementById('cvFile').removeAttribute('required');
                        document.getElementById('cvText').setAttribute('required', 'required');
                    }
                });
            });

            // Cover letter type radio buttons
            document.querySelectorAll('input[name="coverLetterType"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const coverLetterFileGroup = document.getElementById('coverLetterFileGroup');
                    const coverLetterTextGroup = document.getElementById('coverLetterTextGroup');
                    
                    if (this.value === 'file') {
                        coverLetterFileGroup.style.display = 'block';
                        coverLetterTextGroup.style.display = 'none';
                        document.getElementById('coverLetterText').removeAttribute('required');
                        document.getElementById('coverLetterFile').setAttribute('required', 'required');
                    } else {
                        coverLetterFileGroup.style.display = 'none';
                        coverLetterTextGroup.style.display = 'block';
                        document.getElementById('coverLetterFile').removeAttribute('required');
                        document.getElementById('coverLetterText').setAttribute('required', 'required');
                    }
                });
            });

            // Handle form submission
            document.getElementById('applicationForm').addEventListener('submit', function(e) {
                e.preventDefault();
                submitApplication();
            });

            // Close modal when clicking outside
            document.getElementById('applicationModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeApplicationModal();
                }
            });
        });

        // Function to submit application
        async function submitApplication() {
            const form = document.getElementById('applicationForm');
            const formData = new FormData(form);
            
            // Validate form
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            // Show loading state
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Submitting...';
            submitBtn.disabled = true;

            try {
                const response = await fetch('https://admin.ct5pride.co.uk/api/apply', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    // Show success message
                    alert('‚úÖ Application submitted successfully! We\'ll be in touch soon.');
                    closeApplicationModal();
                } else {
                    // Show error message
                    alert(`‚ùå Application failed: ${result.message || 'Unknown error occurred'}`);
                }
            } catch (error) {
                console.error('Application submission error:', error);
                alert('‚ùå Application failed: Network error. Please try again.');
            } finally {
                // Reset button state
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        }
    </script>
    
    <!-- Dynamic Role Loading Script -->
    <script type="module">
        // Role icons mapping
        const roleIcons = {
            'volunteers': 'üåà',
            'events': 'üéâ',
            'marketing': 'üì¢',
            'fundraising': 'üí∞',
            'community': 'ü§ù',
            'admin': 'üìã',
            'support': 'üí¨',
            'creative': 'üé®',
            'tech': 'üíª',
            'outreach': 'üìç'
        };

        // Function to load roles from Supabase API
        async function loadRoles() {
            try {
                console.log('üåê Loading roles from public API...');
                
                // Fetch from public API (no auth required)
                const apiUrl = 'https://admin.ct5pride.co.uk/api/roles/public';
                console.log('üîó Fetching roles from:', apiUrl);
                const response = await fetch(apiUrl, { credentials: 'omit' });
                if (response.ok) {
                    const data = await response.json();
                    console.log('‚úÖ API response:', data);
                    if (!data.roles || !Array.isArray(data.roles)) {
                        console.warn('‚ö†Ô∏è API did not return roles array:', data);
                        return [];
                    }
                    console.log(`‚úÖ Loaded ${data.roles.length} published roles`);
                    return data.roles;
                } else {
                    console.error('‚ùå API response not ok:', response.status, response.statusText);
                    throw new Error(`API error: ${response.status}`);
                }
            } catch (error) {
                console.error('Failed to load roles from API:', error);
                // Return empty array if API fails
                return [];
            }
        }

        // Function to create role cards
        function createRoleCard(role) {
            const isOpen = role.status === 'open';
            
            return `
                <div class="role-card ${!isOpen ? 'draft' : ''}" data-role-id="${role.id}" tabindex="0" role="button" aria-label="View details for ${role.title}">
                    <div class="role-header">
                        <div class="role-icon">${roleIcons[role.icon] || roleIcons['volunteers']}</div>
                        <div class="role-info">
                            <h3>${role.title}</h3>
                            <span class="role-department">${role.department || 'General'}</span>
                            ${!isOpen ? '<span class="draft-badge">Preview</span>' : ''}
                        </div>
                    </div>
                    <p class="role-summary">${role.summary || role.description?.substring(0, 150) + '...' || 'Join our volunteer team!'}</p>
                    <div class="role-actions">
                        ${role.description || role.essential_criteria || role.desirable_criteria ? 
                            `<button class="view-btn" data-id="${role.id}">View details / Apply</button>` : 
                            `<button class="apply-direct" onclick="openApplicationModal('${role.id}', '${role.title}')">Apply now</button>`
                        }
                    </div>
                </div>
            `;
        }

        // Function to format criteria text into list items
        function formatCriteria(criteriaText) {
            if (!criteriaText) return '<li>No criteria specified</li>';
            
            // Split by line breaks only - each line should be a complete criteria item
            const items = criteriaText.split(/\n/).filter(item => item.trim());
            
            if (items.length === 0) return '<li>No criteria specified</li>';
            
            // Format each item as a list item, preserving the full stop
            return items.map(item => {
                const trimmedItem = item.trim();
                return `<li>${trimmedItem}</li>`;
            }).join('');
        }

        // Function to create modal for role details
        function createRoleModal(role) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h2>${role.title}</h2>
                    <p class="role-department">${role.department || 'General'}</p>
                    <div class="role-description">${role.description || '<p>No detailed description available for this role.</p>'}</div>
                    
                    ${role.essential_criteria ? `
                    <div class="role-criteria">
                        <h3>üü¢ Essential Criteria</h3>
                        <ul>
                            ${formatCriteria(role.essential_criteria)}
                        </ul>
                    </div>
                    ` : ''}
                    
                    ${role.desirable_criteria ? `
                    <div class="role-criteria">
                        <h3>üîµ Desirable Criteria</h3>
                        <ul>
                            ${formatCriteria(role.desirable_criteria)}
                        </ul>
                    </div>
                    ` : ''}
                    
                    <div class="role-details">
                        <p><strong>üìç Location:</strong> ${role.location || 'Remote/Flexible'}</p>
                        <p><strong>‚è∞ Time Commitment:</strong> ${role.time_commitment || 'Flexible'}</p>
                        <p><strong>üë• Reporting Line:</strong> ${role.reporting_line || 'To be discussed'}</p>
                    </div>
                    <button class="apply-button" onclick="openApplicationModal('${role.id}', '${role.title}')">Apply for This Role</button>
                </div>
            `;
            return modal;
        }

        // Initialize role loading
        async function initializeRoles() {
            const container = document.getElementById('role-board');
            if (!container) return;

            // Show loading state
            container.innerHTML = `
                <div class="loading-message">
                    <h3>üåà Loading Volunteer Opportunities...</h3>
                    <div class="loading-spinner"></div>
                </div>
            `;

            try {
                // Load roles from API
                const roles = await loadRoles();
                
                // Check if we should show draft roles
                const showDraft = new URLSearchParams(window.location.search).get('preview') === 'true';
                
                // Filter roles - only show open roles and draft roles if in preview mode
                const visibleRoles = roles.filter(role => {
                    if (role.status === 'open') return true;
                    if (role.status === 'draft' && showDraft) return true;
                    return false; // Hide closed roles completely
                });

                if (!visibleRoles.length) {
                    container.innerHTML = `
                        <div class="no-roles-message">
                            <h3>üåà No Open Positions Currently</h3>
                            <p>We're not actively recruiting for new volunteer positions right now, but we'd still love to hear from you! 
                            <a href="contact.html">Get in touch</a> to learn about future opportunities.</p>
                        </div>
                    `;
                    return;
                }

                // Create role grid
                container.innerHTML = visibleRoles.map(role => createRoleCard(role)).join('');

                // IMPORTANT: Add event listeners AFTER roles are injected into DOM
                // Use setTimeout to ensure DOM is fully updated
                setTimeout(() => {
                    // Add click handlers for view buttons (these are the "View details / Apply" buttons)
                    document.querySelectorAll('.view-btn').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            e.preventDefault();
                            e.stopPropagation();
                            const roleId = btn.getAttribute('data-id');
                            const role = visibleRoles.find(r => r.id == roleId);
                            if (role) {
                                openRoleModal(role);
                            }
                        });
                    });

                    // Add click handlers for role cards (for accessibility and general interaction)
                    document.querySelectorAll('[data-role-id]').forEach(card => {
                        card.addEventListener('click', (e) => {
                            // Only trigger if clicking on the card itself, not on buttons/links
                            if (e.target === card || e.target.closest('.role-header') || e.target.closest('.role-summary')) {
                                e.preventDefault();
                                const roleId = card.getAttribute('data-role-id');
                                const role = visibleRoles.find(r => r.id == roleId);
                                if (role) {
                                    openRoleModal(role);
                                }
                            }
                        });
                        
                        // Keyboard accessibility
                        card.addEventListener('keydown', (e) => {
                            if (e.key === 'Enter' || e.key === ' ') {
                                e.preventDefault();
                                const roleId = card.getAttribute('data-role-id');
                                const role = visibleRoles.find(r => r.id == roleId);
                                if (role) {
                                    openRoleModal(role);
                                }
                            }
                        });
                    });
                }, 100); // Small delay to ensure DOM is ready

            } catch (error) {
                console.error('Failed to initialize roles:', error);
                container.innerHTML = `
                    <div class="error-message">
                        <h3>‚ö†Ô∏è Unable to Load Roles</h3>
                        <p>We're having trouble loading our volunteer opportunities right now. Please try refreshing the page or <a href="contact.html">contact us</a> directly.</p>
                    </div>
                `;
            }
        }

        // Function to open role modal
        function openRoleModal(role) {
            const modal = createRoleModal(role);
            document.body.appendChild(modal);
            
            // Show modal with animation
            setTimeout(() => modal.classList.add('show'), 10);
            
            // Close handlers
            const closeModal = () => {
                modal.classList.remove('show');
                setTimeout(() => modal.remove(), 300);
            };
            
            // Close button handler
            modal.querySelector('.close').onclick = closeModal;
            
            // Click outside modal to close
            modal.onclick = (e) => {
                if (e.target === modal) closeModal();
            };
            
            // Close on Escape key
            const handleEscape = (e) => {
                if (e.key === 'Escape') {
                    closeModal();
                    document.removeEventListener('keydown', handleEscape);
                }
            };
            document.addEventListener('keydown', handleEscape);
            
            // Focus management - focus the close button for accessibility
            setTimeout(() => {
                const closeBtn = modal.querySelector('.close');
                if (closeBtn) closeBtn.focus();
            }, 100);
        }

        // Make openRoleModal globally available
        window.openRoleModal = openRoleModal;

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeRoles);
        } else {
            initializeRoles();
        }

    </script>
</body>
</html> 
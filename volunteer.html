<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Security Meta Tags -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    
    <link rel="icon" type="image/svg+xml" href="Images/Logo-with-Transparent-background.svg">
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <title>Volunteer Opportunities - CT5 Pride</title>
    <meta name="description" content="Volunteer with CT5 Pride and help create inclusive events and support for the LGBTQ+ community in Whitstable.">
    
    <!-- OpenGraph/Social Media Meta Tags -->
    <meta property="og:title" content="Volunteer Opportunities - CT5 Pride">
    <meta property="og:description" content="Volunteer with CT5 Pride and help create inclusive events and support for the LGBTQ+ community in Whitstable.">
    <meta property="og:image" content="https://ct5pride.org.uk/Images/Logo-with-Transparent-background.svg">
    <meta property="og:url" content="https://ct5pride.org.uk/volunteer.html">
    <meta property="og:type" content="website">
</head>
<body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Progress Pride Flag Stripe -->
    <div class="pride-stripe" role="banner" aria-label="Progress Pride Flag"></div>
    
    <header>
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo-link" aria-label="CT5 Pride Homepage">
                    <img src="Images/Logo-with-Transparent-background.svg" alt="CT5 Pride logo" class="site-logo">
                </a>
                
                <button class="nav-toggle" aria-label="Toggle navigation menu" aria-expanded="false">
                    ‚ò∞
                </button>
                
                <nav role="navigation" aria-label="Main navigation">
                    <ul>
                        <li><a href="index.html" >Home</a></li>
                        <li class="dropdown">
                            <a href="#" aria-haspopup="true" aria-expanded="false">About</a>
                            <ul class="dropdown-content" role="menu">
                                <li role="none"><a href="about.html" role="menuitem">About Us</a></li>
                                <li role="none"><a href="team.html" role="menuitem">Our Team</a></li>
                            </ul>
                        </li>
                        <li><a href="events.html">Events</a></li>
                        <li class="dropdown">
                            <a href="#" aria-haspopup="true" aria-expanded="false">Get Involved</a>
                            <ul class="dropdown-content" role="menu">
                                <li role="none"><a href="get-involved.html" role="menuitem">Overview</a></li>
                                <li role="none"><a href="volunteer.html" role="menuitem" aria-current="page">Volunteer Opportunities</a></li>
        
                                <li role="none"><a href="contact.html" role="menuitem">Contact Us</a></li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" aria-haspopup="true" aria-expanded="false">Support & Education</a>
                            <ul class="dropdown-content" role="menu">
                                <li role="none"><a href="help-support.html" role="menuitem">Help & Support</a></li>
                                <li role="none"><a href="education.html" role="menuitem">Education Resources</a></li>
                                <li role="none"><a href="pride-quiz.html" role="menuitem">Pride Knowledge Quiz</a></li>
                            </ul>
                        </li>
                        <li class="donate-button">
                            <a href="https://www.justgiving.com/crowdfunding/ct5pride" target="_blank" rel="noopener noreferrer" class="donate-link">
                                üíù Donate
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <main id="main-content">
        <!-- Enhanced Volunteer Hero Section -->
        <section class="hero decorative-shapes" style="background: var(--cosmic-gradient); padding: 4rem 0; position: relative; width: 100%;">
            <!-- IDEOGRAM GRAPHIC ACTIVE: volunteer_community_background.svg background -->
            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('Images/volunteer_community_background.svg') center/cover no-repeat; opacity: 0.2; z-index: 1;"></div>
            <div class="container" style="position: relative; z-index: 2;">
                <div style="text-align: center; color: white; max-width: 800px; margin: 0 auto;">
                    <h1 style="font-size: 3.5rem; margin-bottom: 2rem;">
                        ü§ù Volunteer With Us
                    </h1>
                    <p style="font-size: 1.4rem; line-height: 1.8; text-shadow: 1px 1px 2px rgba(0,0,0,0.2);">
                        Join our passionate team of volunteers and help create meaningful change in the LGBTQIA+ 
                        community. Every skill, every hour, and every heart makes a difference.
                    </p>
                </div>
            </div>
        </section>

        <!-- Vibrant Section Divider -->
        <div class="section-divider" role="separator" aria-hidden="true"></div>

        <!-- Enhanced Why Volunteer Section -->
        <section class="decorative-shapes" style="background: var(--pastel-gradient); padding: 4rem 0;">
            <div class="container">
                <h2 style="text-align: center; font-size: 2.5rem; margin-bottom: 3rem; color: var(--text);">
                    ‚ú® Why Volunteer with CT5 Pride?
                </h2>
                <div class="cta-grid">
                    <div style="background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,240,245,0.95) 100%); padding: 3rem; border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); border-top: 6px solid var(--rainbow-gradient); text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üíù</div>
                        <h3 style="color: var(--primary); font-size: 1.5rem; margin-bottom: 1rem; font-weight: 700;">Make a Real Impact</h3>
                        <p style="font-size: 1.1rem; color: var(--text); line-height: 1.6;">
                            Your contributions directly support LGBTQIA+ individuals and help build a more 
                            inclusive community where everyone can thrive.
                        </p>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(240,255,255,0.95) 100%); padding: 3rem; border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); border-top: 6px solid var(--warm-gradient); text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üåü</div>
                        <h3 style="color: var(--primary); font-size: 1.5rem; margin-bottom: 1rem; font-weight: 700;">Develop New Skills</h3>
                        <p style="font-size: 1.1rem; color: var(--text); line-height: 1.6;">
                            Gain valuable experience in event planning, community outreach, marketing, 
                            and leadership while working alongside passionate team members.
                        </p>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,250,250,0.95) 100%); padding: 3rem; border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); border-top: 6px solid var(--pastel-gradient); text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ü§ó</div>
                        <h3 style="color: var(--primary); font-size: 1.5rem; margin-bottom: 1rem; font-weight: 700;">Build Lasting Friendships</h3>
                        <p style="font-size: 1.1rem; color: var(--text); line-height: 1.6;">
                            Connect with like-minded individuals who share your passion for equality, 
                            community building, and creating positive change.
                        </p>
                    </div>

                    <div style="background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,224,0.95) 100%); padding: 3rem; border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); border-top: 6px solid #ffe066; text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üé´</div>
                        <h3 style="color: var(--primary); font-size: 1.5rem; margin-bottom: 1rem; font-weight: 700;">Free CT5 Pride Membership</h3>
                        <p style="font-size: 1.1rem; color: var(--text); line-height: 1.6;">
                            All volunteers receive free membership to CT5 Pride, giving you access to member-only events, updates, and more.
                        </p>
                    </div>

                    <div style="background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(230,245,255,0.95) 100%); padding: 3rem; border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); border-top: 6px solid #6ec6ff; text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üõçÔ∏è</div>
                        <h3 style="color: var(--primary); font-size: 1.5rem; margin-bottom: 1rem; font-weight: 700;">Access to Exclusive Merch</h3>
                        <p style="font-size: 1.1rem; color: var(--text); line-height: 1.6;">
                            Volunteers get early access and special discounts on exclusive CT5 Pride merchandise and swag.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Vibrant Section Divider -->
        <div class="section-divider" role="separator" aria-hidden="true"></div>

        <!-- Enhanced Volunteer Opportunities Section -->
        <section id="volunteer-roles" class="decorative-shapes" style="padding: 4rem 0; background: rgba(255,255,255,0.95);">
            <!-- IDEOGRAM GRAPHIC ACTIVE: volunteer_community_background.svg is displaying via CSS .role-board::before -->
            <div class="container">
                <h2 style="text-align: center; font-size: 2.5rem; margin-bottom: 3rem; color: var(--text);">
                    üåà Current Volunteer Opportunities
                </h2>
                <div class="role-board" id="role-board">
                    <!-- Volunteer roles will be dynamically loaded here -->
                </div>
            </div>
        </section>

        <!-- Vibrant Section Divider -->
        <div class="section-divider" role="separator" aria-hidden="true"></div>

        <!-- Enhanced Getting Started Section -->
        <section class="decorative-shapes" style="background: var(--cosmic-gradient); padding: 4rem 0;">
            <div class="container">
                <div style="max-width: 800px; margin: 0 auto; text-align: center;">
                    <h2 style="font-size: 2.5rem; margin-bottom: 2rem; color: white;">
                        üöÄ Ready to Get Started?
                    </h2>
                    <div style="background: rgba(255,255,255,0.95); padding: 3rem; border-radius: 20px; backdrop-filter: blur(10px); border: 2px solid rgba(255,255,255,0.3); margin-bottom: 2rem; box-shadow: 0 15px 40px rgba(0,0,0,0.2);">
                        <p style="font-size: 1.3rem; line-height: 1.8; margin-bottom: 2rem; color: var(--text); text-shadow: none;">
                            Getting involved is easy! Simply click on any role that interests you to learn more 
                            and submit an application. We'll be in touch within a few days to discuss next steps.
                        </p>
                        <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                            <a href="contact.html" class="button" style="background: var(--accent); color: white; border: 3px solid var(--accent); font-size: 1.1rem; padding: 1rem 2rem;">
                                Have Questions?
                            </a>
                            <a href="about.html" class="button secondary" style="font-size: 1.1rem; padding: 1rem 2rem;">
                                Learn About Us
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-layout">
                <!-- Left Section: Company Info -->
                <div class="footer-info">
                    <h3>CT5 Pride Community Interest Company</h3>
                    <div class="contact-links">
                        <a href="mailto:hello@ct5pride.org.uk" aria-label="Email CT5 Pride">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                            </svg>
                            hello@ct5pride.org.uk
                        </a>
                        <a href="privacy.html">Privacy Policy</a>
                    </div>
                </div>
                
                <!-- Center Section: Pride Flags -->
                <div class="footer-flags">
                    <div class="flag-section-title">
                        <p>Click flags for temporary themes</p>
                    </div>
                    <div class="flags-grid">
                        <!-- Row 1 -->
                        <div class="pride-flag-icon default-theme" 
                             role="button" 
                             aria-label="Default CT5 Pride Theme"
                             tabindex="0"
                             data-theme="default"
                             title="CT5 Pride Default Theme"></div>
                        <div class="pride-flag-icon rainbow-flag" 
                             role="button" 
                             aria-label="Rainbow Pride Flag"
                             tabindex="0"
                             data-theme="rainbow"
                             title="Rainbow Pride Flag"></div>
                        <div class="pride-flag-icon progress-flag" 
                             role="button" 
                             aria-label="Progress Pride Flag"
                             tabindex="0"
                             data-theme="progress"
                             title="Progress Pride Flag"></div>
                        <div class="pride-flag-icon trans-flag" 
                             role="button" 
                             aria-label="Transgender Pride Flag"
                             tabindex="0"
                             data-theme="trans"
                             title="Transgender Pride Flag"></div>
                        <div class="pride-flag-icon nonbinary-flag" 
                             role="button" 
                             aria-label="Non-Binary Pride Flag"
                             tabindex="0"
                             data-theme="nonbinary"
                             title="Non-Binary Pride Flag"></div>
                        
                        <!-- Row 2 -->
                        <div class="pride-flag-icon lesbian-flag" 
                             role="button" 
                             aria-label="Lesbian Pride Flag"
                             tabindex="0"
                             data-theme="lesbian"
                             title="Lesbian Pride Flag"></div>
                        <div class="pride-flag-icon gay-flag" 
                             role="button" 
                             aria-label="Gay Pride Flag"
                             tabindex="0"
                             data-theme="gay"
                             title="Gay Pride Flag"></div>
                        <div class="pride-flag-icon bisexual-flag" 
                             role="button" 
                             aria-label="Bisexual Pride Flag"
                             tabindex="0"
                             data-theme="bisexual"
                             title="Bisexual Pride Flag"></div>
                        <div class="pride-flag-icon pansexual-flag" 
                             role="button" 
                             aria-label="Pansexual Pride Flag"
                             tabindex="0"
                             data-theme="pansexual"
                             title="Pansexual Pride Flag"></div>
                        <div class="pride-flag-icon asexual-flag" 
                             role="button" 
                             aria-label="Asexual Pride Flag"
                             tabindex="0"
                             data-theme="asexual"
                             title="Asexual Pride Flag"></div>
                        <div class="pride-flag-icon bear-flag" 
                             role="button" 
                             aria-label="Bear Pride Flag"
                             tabindex="0"
                             data-theme="bear"
                             title="Bear Pride Flag"></div>
                        <div class="pride-flag-icon omnisexual-flag" 
                             role="button" 
                             aria-label="Omnisexual Pride Flag"
                             tabindex="0"
                             data-theme="omnisexual"
                             title="Omnisexual Pride Flag"></div>
                    </div>
                </div>
                
                <!-- Right Section: Social Links -->
                <div class="footer-social">
                    <div class="social-links">
                    <a href="https://www.facebook.com/CT5Pride" target="_blank" rel="noopener noreferrer" 
                       aria-label="Follow us on Facebook">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                        </svg>
                    </a>
                    <a href="https://www.instagram.com/ct5pride" target="_blank" rel="noopener noreferrer" 
                       aria-label="Follow us on Instagram">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.40s-.644-1.44-1.439-1.44z"/>
                        </svg>
                    </a>
                    <a href="https://www.linkedin.com/company/ct5-pride" target="_blank" rel="noopener noreferrer" 
                       aria-label="Follow us on LinkedIn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                    </a>
                    <a href="mailto:hello@ct5pride.org.uk" aria-label="Email us">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                        </svg>
                    </a>
                    </div>
                    
                    <!-- Facebook Community Group Button -->
                    <div style="margin-top: 1.5rem; text-align: center;">
                        <a href="https://www.facebook.com/groups/1452370402865655/" 
                           target="_blank" 
                           rel="noopener noreferrer" 
                           style="display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.6rem 1rem; background: linear-gradient(135deg, #1877f2, #42a5f5); color: white; text-decoration: none; border-radius: 6px; font-weight: 600; font-size: 0.85rem; transition: all 0.3s ease; box-shadow: 0 2px 6px rgba(24, 119, 242, 0.3); white-space: nowrap; min-width: fit-content;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                            </svg>
                            Join our Facebook Community Group
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Enhanced Accessibility Panel -->
    <div class="accessibility-panel">
        <button class="accessibility-toggle" aria-label="Open accessibility options" aria-expanded="false">
            ‚ôø
        </button>
        <div class="accessibility-menu" role="dialog" aria-labelledby="accessibility-title">
            <h3 id="accessibility-title">Accessibility Options</h3>
            
            <div class="accessibility-option">
                <label for="high-contrast-toggle">High Contrast Mode</label>
                <div class="accessibility-toggle-switch" 
                     id="high-contrast-toggle"
                     role="switch" 
                     aria-checked="false" 
                     tabindex="0"
                     data-setting="high-contrast">
                </div>

    <script src="js/main.js"></script>
    
    <!-- Application Modal JavaScript -->
    <script>
        // Global variables for application modal
        let currentRoleId = null;
        let currentRoleTitle = null;

        // Function to open application modal
        function openApplicationModal(roleId, roleTitle) {
            currentRoleId = roleId;
            currentRoleTitle = roleTitle;
            
            // Set modal title and hidden fields
            document.getElementById('applicationModalTitle').textContent = `Apply for: ${roleTitle}`;
            document.getElementById('roleId').value = roleId;
            document.getElementById('roleTitle').value = roleTitle;
            
            // Show modal
            document.getElementById('applicationModal').style.display = 'flex';
            
            // Focus on first input for accessibility
            setTimeout(() => {
                document.getElementById('applicantName').focus();
            }, 100);
            
            // Add escape key handler
            document.addEventListener('keydown', handleApplicationEscape);
        }

        // Function to close application modal
        function closeApplicationModal() {
            document.getElementById('applicationModal').style.display = 'none';
            document.getElementById('applicationForm').reset();
            
            // Hide all conditional form groups
            document.getElementById('cvFileGroup').style.display = 'none';
            document.getElementById('cvTextGroup').style.display = 'none';
            document.getElementById('coverLetterFileGroup').style.display = 'none';
            document.getElementById('coverLetterTextGroup').style.display = 'none';
            
            // Remove escape key handler
            document.removeEventListener('keydown', handleApplicationEscape);
        }

        // Handle escape key for application modal
        function handleApplicationEscape(e) {
            if (e.key === 'Escape') {
                closeApplicationModal();
            }
        }

        // Handle CV type selection
        document.addEventListener('DOMContentLoaded', function() {
            // CV type radio buttons
            document.querySelectorAll('input[name="cvType"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const cvFileGroup = document.getElementById('cvFileGroup');
                    const cvTextGroup = document.getElementById('cvTextGroup');
                    
                    if (this.value === 'file') {
                        cvFileGroup.style.display = 'block';
                        cvTextGroup.style.display = 'none';
                        document.getElementById('cvText').removeAttribute('required');
                        document.getElementById('cvFile').setAttribute('required', 'required');
                    } else {
                        cvFileGroup.style.display = 'none';
                        cvTextGroup.style.display = 'block';
                        document.getElementById('cvFile').removeAttribute('required');
                        document.getElementById('cvText').setAttribute('required', 'required');
                    }
                });
            });

            // Cover letter type radio buttons
            document.querySelectorAll('input[name="coverLetterType"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const coverLetterFileGroup = document.getElementById('coverLetterFileGroup');
                    const coverLetterTextGroup = document.getElementById('coverLetterTextGroup');
                    
                    if (this.value === 'file') {
                        coverLetterFileGroup.style.display = 'block';
                        coverLetterTextGroup.style.display = 'none';
                        document.getElementById('coverLetterText').removeAttribute('required');
                        document.getElementById('coverLetterFile').setAttribute('required', 'required');
                    } else {
                        coverLetterFileGroup.style.display = 'none';
                        coverLetterTextGroup.style.display = 'block';
                        document.getElementById('coverLetterFile').removeAttribute('required');
                        document.getElementById('coverLetterText').setAttribute('required', 'required');
                    }
                });
            });

            // Handle form submission
            document.getElementById('applicationForm').addEventListener('submit', function(e) {
                e.preventDefault();
                submitApplication();
            });

            // Close modal when clicking outside
            document.getElementById('applicationModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeApplicationModal();
                }
            });
        });

        // Function to submit application
        async function submitApplication() {
            const form = document.getElementById('applicationForm');
            const formData = new FormData(form);
            
            // Validate form
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            // Show loading state
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Submitting...';
            submitBtn.disabled = true;

            try {
                const response = await fetch('https://admin.ct5pride.co.uk/api/apply', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    // Show success message
                    alert('‚úÖ Application submitted successfully! We\'ll be in touch soon.');
                    closeApplicationModal();
                } else {
                    // Show error message
                    alert(`‚ùå Application failed: ${result.message || 'Unknown error occurred'}`);
                }
            } catch (error) {
                console.error('Application submission error:', error);
                alert('‚ùå Application failed: Network error. Please try again.');
            } finally {
                // Reset button state
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        }
    </script>
    
    <!-- Dynamic Role Loading Script -->
    <script type="module">
        // Role icons mapping
        const roleIcons = {
            'volunteers': 'üåà',
            'events': 'üéâ',
            'marketing': 'üì¢',
            'fundraising': 'üí∞',
            'community': 'ü§ù',
            'admin': 'üìã',
            'support': 'üí¨',
            'creative': 'üé®',
            'tech': 'üíª',
            'outreach': 'üìç'
        };

        // üîí LOCKED DOWN: Enhanced role loading with caching, timeout, and monitoring
        async function loadRoles() {
            const API_URL = 'https://admin.ct5pride.co.uk/api/roles/public';
            const CACHE_KEY = 'ct5pride_volunteer_roles';
            const CACHE_TIMESTAMP_KEY = 'ct5pride_volunteer_roles_timestamp';
            const CACHE_DURATION = 5 * 60 * 1000; // 5 minutes cache
            
            // üîß MOBILE FIX: Detect mobile and adjust timeout accordingly
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                             window.innerWidth <= 768 || 
                             'ontouchstart' in window;
            const REQUEST_TIMEOUT = isMobile ? 20000 : 15000; // 20s for mobile, 15s for desktop
            const MAX_RETRIES = isMobile ? 3 : 2; // More retries for mobile
            
            try {
                console.log('üåê Loading roles from public API with enhanced security...');
                
                // üîí SECURITY: Check for cached data first (reduces server load)
                const cached = localStorage.getItem(CACHE_KEY);
                const cacheTimestamp = localStorage.getItem(CACHE_TIMESTAMP_KEY);
                
                if (cached && cacheTimestamp) {
                    const age = Date.now() - parseInt(cacheTimestamp);
                    if (age < CACHE_DURATION) {
                        console.log('üì¶ Using valid cached roles data (age: ' + Math.round(age/1000) + 's)');
                        try {
                            const cachedRoles = JSON.parse(cached);
                            if (Array.isArray(cachedRoles) && cachedRoles.length > 0) {
                                return cachedRoles;
                            }
                        } catch (e) {
                            console.warn('‚ö†Ô∏è Cached data corrupted, clearing cache');
                            localStorage.removeItem(CACHE_KEY);
                            localStorage.removeItem(CACHE_TIMESTAMP_KEY);
                        }
                    }
                }
                
                // üîß MOBILE FIX: Implement retry logic for mobile devices
                console.log(`üîó Fetching roles from: ${API_URL} (Mobile: ${isMobile}, Timeout: ${REQUEST_TIMEOUT}ms, Retries: ${MAX_RETRIES})`);
                
                let response;
                let lastError;
                
                for (let attempt = 1; attempt <= MAX_RETRIES; attempt++) {
                    try {
                        console.log(`üì± Attempt ${attempt}/${MAX_RETRIES} to fetch roles...`);
                        
                        // üîí SECURITY: Add request timeout to prevent hanging
                        const controller = new AbortController();
                        const timeoutId = setTimeout(() => {
                            controller.abort();
                            console.error(`‚è∞ Request timeout after ${REQUEST_TIMEOUT}ms (attempt ${attempt})`);
                        }, REQUEST_TIMEOUT);
                        
                        // üîí SECURITY: Enhanced fetch with headers and timeout
                        response = await fetch(API_URL, { 
                            credentials: 'omit',
                            signal: controller.signal,
                            headers: {
                                'Accept': 'application/json',
                                'Cache-Control': isMobile && attempt > 1 ? 'no-cache' : 'max-age=0',
                                'User-Agent': `CT5Pride-Website/1.0 (${isMobile ? 'Mobile' : 'Desktop'})`
                            }
                        });
                        
                        clearTimeout(timeoutId);
                        
                        // If we get here, the request succeeded
                        console.log(`‚úÖ Successfully fetched on attempt ${attempt}`);
                        break; // Exit retry loop
                        
                    } catch (error) {
                        lastError = error;
                        console.warn(`‚ö†Ô∏è Attempt ${attempt} failed:`, error.message);
                        
                        // Don't retry on the last attempt
                        if (attempt === MAX_RETRIES) {
                            throw error;
                        }
                        
                        // Wait before retrying (exponential backoff for mobile)
                        const delay = isMobile ? (attempt * 1000) : 500;
                        console.log(`‚è≥ Waiting ${delay}ms before retry...`);
                        await new Promise(resolve => setTimeout(resolve, delay));
                    }
                }
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('‚úÖ API response received:', data);
                
                // üîí SECURITY: Validate response structure thoroughly
                if (!data || typeof data !== 'object') {
                    throw new Error('Invalid response: not an object');
                }
                
                if (data.success === false) {
                    throw new Error(`API Error: ${data.message || 'Unknown API error'}`);
                }
                
                if (!data.roles || !Array.isArray(data.roles)) {
                    console.warn('‚ö†Ô∏è API returned no roles array, using fallback');
                    return getFallbackRoles();
                }
                
                // üîí SECURITY: Validate role data integrity
                const validRoles = data.roles.filter(role => {
                    return role && 
                           typeof role === 'object' && 
                           role.id && 
                           role.title && 
                           role.status === 'open';
                });
                
                if (validRoles.length !== data.roles.length) {
                    console.warn(`‚ö†Ô∏è Filtered ${data.roles.length - validRoles.length} invalid roles`);
                }
                
                // üîí SECURITY: Cache successful response
                try {
                    localStorage.setItem(CACHE_KEY, JSON.stringify(validRoles));
                    localStorage.setItem(CACHE_TIMESTAMP_KEY, Date.now().toString());
                    console.log('üíæ Cached ' + validRoles.length + ' roles for future use');
                } catch (e) {
                    console.warn('‚ö†Ô∏è Failed to cache roles (storage full?)');
                }
                
                console.log(`‚úÖ Loaded ${validRoles.length} validated roles`);
                return validRoles;
                
            } catch (error) {
                console.error(`‚ùå Failed to load roles from API after ${MAX_RETRIES} attempts:`, error.message);
                
                // üîß MOBILE FIX: Enhanced mobile-specific error reporting
                if (isMobile) {
                    console.log('üì± Mobile device detected - checking connection and cache options...');
                    
                    // Report network status for mobile debugging
                    if ('navigator' in window && 'onLine' in navigator) {
                        console.log(`üì± Network status: ${navigator.onLine ? 'Online' : 'Offline'}`);
                    }
                    if ('connection' in navigator) {
                        const conn = navigator.connection;
                        console.log(`üì± Connection info: ${conn.effectiveType || 'unknown'}, downlink: ${conn.downlink || 'unknown'}Mbps`);
                    }
                }
                
                // üîí FALLBACK: Try stale cache first (more aggressive for mobile)
                const staleCache = localStorage.getItem(CACHE_KEY);
                if (staleCache) {
                    try {
                        const staleCachedRoles = JSON.parse(staleCache);
                        if (Array.isArray(staleCachedRoles) && staleCachedRoles.length > 0) {
                            const cacheAge = Date.now() - parseInt(localStorage.getItem(CACHE_TIMESTAMP_KEY) || '0');
                            console.log(`üîÑ Using stale cached data (age: ${Math.round(cacheAge / 1000 / 60)}min) as emergency fallback`);
                            
                            // For mobile, extend cache timestamp so it doesn't try API again too soon
                            if (isMobile) {
                                localStorage.setItem(CACHE_TIMESTAMP_KEY, (Date.now() - CACHE_DURATION + 60000).toString()); // Give 1 min buffer
                            }
                            
                            return staleCachedRoles;
                        }
                    } catch (e) {
                        console.warn('‚ö†Ô∏è Stale cache corrupted');
                    }
                }
                
                // üîí FINAL FALLBACK: Use hardcoded roles
                console.log(`üîÑ Using hardcoded fallback roles... (${isMobile ? 'Mobile' : 'Desktop'} mode)`);
                return getFallbackRoles();
            }
        }

        // Fallback roles for when API is unavailable
        function getFallbackRoles() {
            return [
                {
                    id: 'fallback-1',
                    title: 'Event Volunteer',
                    department: 'Events',
                    icon: 'events',
                    status: 'open',
                    summary: 'Help us create amazing Pride events! Support with setup, registration, and ensuring everyone has a great time.',
                    description: `<p>We're looking for enthusiastic volunteers to help with our Pride events throughout the year.</p>
                    <p>You'll be part of a welcoming team helping to create safe, fun, and inclusive events for our community.</p>`,
                    essential_criteria: `Enthusiasm for LGBTQ+ community support
Available for weekend events
Good communication skills
Reliable and punctual`,
                    desirable_criteria: `Previous event experience
First aid qualification
Social media skills`
                },
                {
                    id: 'fallback-2',
                    title: 'Community Outreach Volunteer',
                    department: 'Community',
                    icon: 'outreach',
                    status: 'open',
                    summary: 'Connect with local LGBTQ+ community members and help spread awareness about CT5 Pride activities.',
                    description: `<p>Join our outreach team to help build connections within the LGBTQ+ community across CT5.</p>
                    <p>You'll help with community engagement, information sharing, and supporting new members.</p>`,
                    essential_criteria: `Passion for LGBTQ+ community building
Good interpersonal skills
Comfortable talking to new people
Available for flexible hours`,
                    desirable_criteria: `Knowledge of local area
Experience with community work
Multilingual abilities`
                },
                {
                    id: 'fallback-3',
                    title: 'Social Media Assistant',
                    department: 'Marketing',
                    icon: 'marketing',
                    status: 'open',
                    summary: 'Help us share our message online! Create content, engage with followers, and spread Pride positivity.',
                    description: `<p>Support our social media presence across platforms to help reach and engage with our community.</p>
                    <p>Perfect opportunity to develop digital marketing skills while supporting LGBTQ+ advocacy.</p>`,
                    essential_criteria: `Active social media user
Creative and engaging writing
Understanding of LGBTQ+ issues
Available for regular posting schedule`,
                    desirable_criteria: `Graphic design skills
Photography experience
Analytics knowledge
Content creation experience`
                }
            ];
        }

        // Function to create role cards
        function createRoleCard(role) {
            const isOpen = role.status === 'open';
            
            return `
                <div class="role-card ${!isOpen ? 'draft' : ''}" data-role-id="${role.id}" tabindex="0" role="button" aria-label="View details for ${role.title}">
                    <div class="role-header">
                        <div class="role-icon">${roleIcons[role.icon] || roleIcons['volunteers']}</div>
                        <div class="role-info">
                            <h3>${role.title}</h3>
                            <span class="role-department">${role.department || 'General'}</span>
                            ${!isOpen ? '<span class="draft-badge">Preview</span>' : ''}
                        </div>
                    </div>
                    <p class="role-summary">${role.summary || role.description?.substring(0, 150) + '...' || 'Join our volunteer team!'}</p>
                    <div class="role-actions">
                        ${role.description || role.essential_criteria || role.desirable_criteria ? 
                            `<button class="view-btn" data-id="${role.id}">View details / Apply</button>` : 
                            `<button class="apply-direct" onclick="openApplicationModal('${role.id}', '${role.title}')">Apply now</button>`
                        }
                    </div>
                </div>
            `;
        }

        // Function to format criteria text into list items
        function formatCriteria(criteriaText) {
            if (!criteriaText) return '<li>No criteria specified</li>';
            
            // Split by line breaks only - each line should be a complete criteria item
            const items = criteriaText.split(/\n/).filter(item => item.trim());
            
            if (items.length === 0) return '<li>No criteria specified</li>';
            
            // Format each item as a list item, preserving the full stop
            return items.map(item => {
                const trimmedItem = item.trim();
                return `<li>${trimmedItem}</li>`;
            }).join('');
        }

        // Function to create modal for role details
        function createRoleModal(role) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h2>${role.title}</h2>
                    <p class="role-department">${role.department || 'General'}</p>
                    <div class="role-description">${role.description || '<p>No detailed description available for this role.</p>'}</div>
                    
                    ${role.essential_criteria ? `
                    <div class="role-criteria">
                        <h3>üü¢ Essential Criteria</h3>
                        <ul>
                            ${formatCriteria(role.essential_criteria)}
                        </ul>
                    </div>
                    ` : ''}
                    
                    ${role.desirable_criteria ? `
                    <div class="role-criteria">
                        <h3>üîµ Desirable Criteria</h3>
                        <ul>
                            ${formatCriteria(role.desirable_criteria)}
                        </ul>
                    </div>
                    ` : ''}
                    
                    <div class="role-details">
                        <p><strong>üìç Location:</strong> ${role.location || 'Remote/Flexible'}</p>
                        <p><strong>‚è∞ Time Commitment:</strong> ${role.time_commitment || 'Flexible'}</p>
                        <p><strong>üë• Reporting Line:</strong> ${role.reporting_line || 'To be discussed'}</p>
                    </div>
                    <button class="apply-button" onclick="openApplicationModal('${role.id}', '${role.title}')">Apply for This Role</button>
                </div>
            `;
            return modal;
        }

        // üîí LOCKED DOWN: Health monitoring and status reporting
        function reportSystemHealth(status, details) {
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                             window.innerWidth <= 768 || 
                             'ontouchstart' in window;
            
            const healthReport = {
                timestamp: new Date().toISOString(),
                status: status, // 'healthy', 'degraded', 'failed'
                details: details,
                userAgent: navigator.userAgent,
                url: window.location.href,
                isMobile: isMobile,
                screenSize: `${window.innerWidth}x${window.innerHeight}`,
                networkStatus: navigator.onLine ? 'online' : 'offline',
                connectionType: navigator.connection ? navigator.connection.effectiveType : 'unknown'
            };
            
            console.log('üìä System Health Report:', healthReport);
            
            // Store health status in localStorage for debugging
            const healthHistory = JSON.parse(localStorage.getItem('ct5pride_health_history') || '[]');
            healthHistory.push(healthReport);
            
            // Keep only last 10 reports
            if (healthHistory.length > 10) {
                healthHistory.shift();
            }
            
            localStorage.setItem('ct5pride_health_history', JSON.stringify(healthHistory));
        }

        // üîí LOCKED DOWN: Enhanced role initialization with monitoring
        async function initializeRoles() {
            const container = document.getElementById('role-board');
            if (!container) {
                console.error('‚ùå Critical: role-board container not found');
                reportSystemHealth('failed', 'Role board container missing');
                return;
            }

            // üîß MOBILE FIX: Enhanced loading state with device-specific messaging
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                             window.innerWidth <= 768 || 
                             'ontouchstart' in window;
            
            container.innerHTML = `
                <div class="loading-message">
                    <h3>üåà Loading Volunteer Opportunities...</h3>
                    <div class="loading-spinner"></div>
                    <p style="font-size: 0.9rem; color: var(--text-light); margin-top: 1rem;">
                        Connecting to secure CT5 Pride volunteer system...
                        ${isMobile ? '<br>üì± Optimized loading for mobile devices' : ''}
                    </p>
                </div>
            `;
            
            const startTime = Date.now();

            try {
                // üîí SECURITY: Load roles with enhanced monitoring
                console.log('üîÑ Loading roles...');
                const roles = await loadRoles();
                const loadTime = Date.now() - startTime;
                
                console.log(`‚è±Ô∏è Roles loaded in ${loadTime}ms`);
                
                // üîí SECURITY: Validate roles data
                if (!Array.isArray(roles)) {
                    throw new Error('Invalid roles data: not an array');
                }
                
                // Check if we should show draft roles (admin preview)
                const showDraft = new URLSearchParams(window.location.search).get('preview') === 'true';
                
                // üîí SECURITY: Enhanced role filtering with validation
                const visibleRoles = roles.filter(role => {
                    // Validate role structure
                    if (!role || typeof role !== 'object') return false;
                    if (!role.title || !role.id) return false;
                    
                    if (role.status === 'open') return true;
                    if (role.status === 'draft' && showDraft) return true;
                    return false; // Hide closed/invalid roles
                });

                console.log(`‚úÖ Filtered to ${visibleRoles.length} visible roles (from ${roles.length} total)`);

                if (!visibleRoles.length) {
                    const isUsingFallback = roles.some(role => role.id && role.id.startsWith('fallback-'));
                    
                    container.innerHTML = `
                        <div class="no-roles-message">
                            <h3>üåà ${isUsingFallback ? 'System Notice' : 'No Open Positions Currently'}</h3>
                            <p>${isUsingFallback ? 
                                'Our volunteer system is currently operating in offline mode. Some positions may not be displayed. Please ' :
                                "We're not actively recruiting for new volunteer positions right now, but we'd still love to hear from you! "
                            }<a href="contact.html">get in touch</a> to learn about ${isUsingFallback ? 'all available' : 'future'} opportunities.</p>
                            ${isUsingFallback ? '<p style="font-size: 0.9rem; color: var(--text-light); margin-top: 1rem;">üì° Status: Operating in offline mode</p>' : ''}
                        </div>
                    `;
                    
                    reportSystemHealth(isUsingFallback ? 'degraded' : 'healthy', 
                        isUsingFallback ? 'Using fallback data' : 'No open roles available');
                    return;
                }

                // üîí SECURITY: Create role grid with data validation
                const roleCards = visibleRoles.map(role => {
                    try {
                        return createRoleCard(role);
                    } catch (error) {
                        console.warn('‚ö†Ô∏è Failed to create card for role:', role.title, error);
                        return ''; // Skip invalid roles
                    }
                }).filter(card => card); // Remove empty cards
                
                container.innerHTML = roleCards.join('');
                
                // üîí MONITORING: Report successful load
                const totalLoadTime = Date.now() - startTime;
                console.log(`üéâ Successfully loaded ${visibleRoles.length} volunteer roles in ${totalLoadTime}ms`);
                
                const isUsingFallback = roles.some(role => role.id && role.id.startsWith('fallback-'));
                reportSystemHealth(isUsingFallback ? 'degraded' : 'healthy', 
                    `Loaded ${visibleRoles.length} roles in ${totalLoadTime}ms${isUsingFallback ? ' (fallback mode)' : ''}`);

                // üîí SECURITY: Add event listeners AFTER roles are injected into DOM with error protection
                setTimeout(() => {
                    // Add click handlers for view buttons (these are the "View details / Apply" buttons)
                    document.querySelectorAll('.view-btn').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            e.preventDefault();
                            e.stopPropagation();
                            const roleId = btn.getAttribute('data-id');
                            const role = visibleRoles.find(r => r.id == roleId);
                            if (role) {
                                openRoleModal(role);
                            }
                        });
                    });

                    // Add click handlers for role cards (for accessibility and general interaction)
                    document.querySelectorAll('[data-role-id]').forEach(card => {
                        card.addEventListener('click', (e) => {
                            // Only trigger if clicking on the card itself, not on buttons/links
                            if (e.target === card || e.target.closest('.role-header') || e.target.closest('.role-summary')) {
                                e.preventDefault();
                                const roleId = card.getAttribute('data-role-id');
                                const role = visibleRoles.find(r => r.id == roleId);
                                if (role) {
                                    openRoleModal(role);
                                }
                            }
                        });
                        
                        // Keyboard accessibility
                        card.addEventListener('keydown', (e) => {
                            if (e.key === 'Enter' || e.key === ' ') {
                                e.preventDefault();
                                const roleId = card.getAttribute('data-role-id');
                                const role = visibleRoles.find(r => r.id == roleId);
                                if (role) {
                                    openRoleModal(role);
                                }
                            }
                        });
                    });
                }, 100); // Small delay to ensure DOM is ready

            } catch (error) {
                // üîí SECURITY: Enhanced error handling with reporting
                const errorTime = Date.now() - startTime;
                console.error('‚ùå Critical: Failed to initialize roles:', error);
                
                // Report system failure
                reportSystemHealth('failed', `Initialization failed after ${errorTime}ms: ${error.message}`);
                
                // Try emergency fallback
                try {
                    console.log('üö® Attempting emergency fallback...');
                    const emergencyRoles = getFallbackRoles();
                    const emergencyCards = emergencyRoles.map(role => createRoleCard(role)).join('');
                    
                    container.innerHTML = `
                        <div class="error-message" style="margin-bottom: 2rem;">
                            <h3>‚ö†Ô∏è ${isMobile ? 'Mobile Connection' : 'System'} Operating in Emergency Mode</h3>
                            <p>Our volunteer system is temporarily experiencing ${isMobile ? 'mobile connectivity issues' : 'technical difficulties'}. The positions below are available, but there may be additional opportunities not shown. Please <a href="contact.html">contact us directly</a> for the most up-to-date information.</p>
                            ${isMobile ? '<p>üì± <strong>Mobile users:</strong> Try refreshing the page or connecting to WiFi for the latest opportunities.</p>' : ''}
                            <p style="font-size: 0.9rem; color: var(--text-light); margin-top: 1rem;">üì° Status: Emergency fallback mode (${isMobile ? 'Mobile' : 'Desktop'}) ‚Ä¢ Error ID: ${Date.now().toString(36)}</p>
                        </div>
                        ${emergencyCards}
                    `;
                    
                    console.log('‚úÖ Emergency fallback successful');
                    reportSystemHealth('degraded', 'Emergency fallback mode active');
                    
                } catch (fallbackError) {
                    console.error('üí• Emergency fallback also failed:', fallbackError);
                    
                    // Final fallback - basic contact message
                    container.innerHTML = `
                        <div class="error-message">
                            <h3>üö® System Temporarily Unavailable</h3>
                            <p>We're experiencing technical difficulties with our volunteer system. Please <a href="contact.html" style="font-weight: bold;">contact us directly</a> to learn about volunteer opportunities.</p>
                            <p>We apologize for the inconvenience and appreciate your interest in volunteering with CT5 Pride! üåà</p>
                            <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(0,0,0,0.05); border-radius: 6px;">
                                <p style="margin: 0; font-size: 0.9rem; color: var(--text-light);">
                                    üìß <strong>Email:</strong> volunteer@ct5pride.co.uk<br>
                                    üìû <strong>Phone:</strong> Available on our contact page<br>
                                    üìç <strong>Location:</strong> Whitstable & CT5 Area, Kent
                                </p>
                            </div>
                            <p style="font-size: 0.8rem; color: var(--text-light); margin-top: 1rem;">Error ID: ${Date.now().toString(36)} ‚Ä¢ Time: ${new Date().toLocaleString()}</p>
                        </div>
                    `;
                    
                    reportSystemHealth('failed', 'Complete system failure - displaying contact information');
                }
            }
        }

        // Function to open role modal
        function openRoleModal(role) {
            const modal = createRoleModal(role);
            document.body.appendChild(modal);
            
            // Show modal with animation
            setTimeout(() => modal.classList.add('show'), 10);
            
            // Close handlers
            const closeModal = () => {
                modal.classList.remove('show');
                setTimeout(() => modal.remove(), 300);
            };
            
            // Close button handler
            modal.querySelector('.close').onclick = closeModal;
            
            // Click outside modal to close
            modal.onclick = (e) => {
                if (e.target === modal) closeModal();
            };
            
            // Close on Escape key
            const handleEscape = (e) => {
                if (e.key === 'Escape') {
                    closeModal();
                    document.removeEventListener('keydown', handleEscape);
                }
            };
            document.addEventListener('keydown', handleEscape);
            
            // Focus management - focus the close button for accessibility
            setTimeout(() => {
                const closeBtn = modal.querySelector('.close');
                if (closeBtn) closeBtn.focus();
            }, 100);
        }

        // Make openRoleModal globally available
        // üîí LOCKED DOWN: System health debugging for admins
        window.CT5PrideDebug = {
            checkHealth: function() {
                const health = JSON.parse(localStorage.getItem('ct5pride_health_history') || '[]');
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                                 window.innerWidth <= 768 || 
                                 'ontouchstart' in window;
                
                console.group('üè• CT5 Pride Volunteer System Health Report');
                console.log('Device Info:', {
                    isMobile: isMobile,
                    screenSize: `${window.innerWidth}x${window.innerHeight}`,
                    userAgent: navigator.userAgent,
                    networkStatus: navigator.onLine ? 'online' : 'offline',
                    connectionType: navigator.connection ? navigator.connection.effectiveType : 'unknown'
                });
                console.log('Recent Health History:', health);
                console.log('Cache Status:', {
                    roles: localStorage.getItem('ct5pride_volunteer_roles') ? 'Present' : 'Empty',
                    lastUpdate: localStorage.getItem('ct5pride_volunteer_roles_timestamp') 
                        ? new Date(parseInt(localStorage.getItem('ct5pride_volunteer_roles_timestamp'))).toLocaleString()
                        : 'Never',
                    cacheAge: localStorage.getItem('ct5pride_volunteer_roles_timestamp') 
                        ? Math.round((Date.now() - parseInt(localStorage.getItem('ct5pride_volunteer_roles_timestamp'))) / 1000 / 60) + ' minutes'
                        : 'N/A'
                });
                console.log('System Status:', health.length > 0 ? health[health.length - 1].status : 'Unknown');
                console.groupEnd();
                return health;
            },
            clearCache: function() {
                localStorage.removeItem('ct5pride_volunteer_roles');
                localStorage.removeItem('ct5pride_volunteer_roles_timestamp');
                console.log('‚úÖ Cache cleared - page refresh recommended');
            },
            testAPI: function() {
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                                 window.innerWidth <= 768 || 
                                 'ontouchstart' in window;
                const timeout = isMobile ? 20000 : 15000;
                
                console.log(`üß™ Testing API with ${timeout}ms timeout (Mobile: ${isMobile})...`);
                
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), timeout);
                
                return fetch('https://admin.ct5pride.co.uk/api/roles/public', {
                    signal: controller.signal,
                    headers: {
                        'Accept': 'application/json',
                        'User-Agent': `CT5Pride-Debug/1.0 (${isMobile ? 'Mobile' : 'Desktop'})`
                    }
                })
                    .then(r => {
                        clearTimeout(timeoutId);
                        return r.json();
                    })
                    .then(d => {
                        console.log('‚úÖ API Test Result:', d);
                        return d;
                    })
                    .catch(e => {
                        clearTimeout(timeoutId);
                        console.error('‚ùå API Test Failed:', e);
                        return { error: e.message, isMobile: isMobile, timeout: timeout };
                    });
            },
            forceMobileMode: function() {
                localStorage.setItem('ct5pride_force_mobile', 'true');
                console.log('üì± Mobile mode forced - refresh page to test mobile behavior');
            },
            resetMobileMode: function() {
                localStorage.removeItem('ct5pride_force_mobile');
                console.log('üñ•Ô∏è Mobile mode reset - refresh page to test normal behavior');
            }
        };

        // Make functions available globally
        window.openRoleModal = openRoleModal;

        // üîí LOCKED DOWN: Initialize when DOM is ready with startup monitoring
        console.log('üöÄ CT5 Pride Volunteer System starting...');
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeRoles);
        } else {
            initializeRoles();
        }
        
        // Add helpful console message for admins
        console.log('üîß Admin Debug: Type CT5PrideDebug.checkHealth() to view system status');

    </script>

    <!-- Enhanced Accessibility Panel -->
    <div class="accessibility-panel">
        <button class="accessibility-toggle" aria-label="Open accessibility options" aria-expanded="false">
            ‚ôø
        </button>
        <div class="accessibility-menu" role="dialog" aria-labelledby="accessibility-title">
            <h3 id="accessibility-title">Accessibility Options</h3>
            
            <div class="accessibility-option">
                <label for="high-contrast-toggle">High Contrast Mode</label>
                <div class="accessibility-toggle-switch" 
                     id="high-contrast-toggle"
                     role="switch" 
                     aria-checked="false" 
                     tabindex="0"
                     data-setting="high-contrast">
                </div>
            </div>
            
            <div class="accessibility-option">
                <label for="dyslexia-toggle">Dyslexia Friendly Font</label>
                <div class="accessibility-toggle-switch" 
                     id="dyslexia-toggle"
                     role="switch" 
                     aria-checked="false" 
                     tabindex="0"
                     data-setting="dyslexia-friendly">
                </div>
            </div>
            
            <div class="accessibility-option">
                <label for="reduce-motion-toggle">Reduce Motion</label>
                <div class="accessibility-toggle-switch" 
                     id="reduce-motion-toggle"
                     role="switch" 
                     aria-checked="false" 
                     tabindex="0"
                     data-setting="reduce-motion">
                </div>
            </div>
            
            <div class="accessibility-option">
                <label for="text-size">Text Size</label>
                <div class="text-size-controls">
                    <button class="text-size-btn" data-size="small" aria-label="Small text size">A</button>
                    <button class="text-size-btn active" data-size="normal" aria-label="Normal text size">A</button>
                    <button class="text-size-btn" data-size="large" aria-label="Large text size">A</button>
                    <button class="text-size-btn" data-size="extra-large" aria-label="Extra large text size">A</button>
                </div>
            </div>
        </div>
    </div>

    <!-- üîí LOCKED DOWN: Application Modal Structure -->
    <div id="applicationModal" class="modal" style="display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); align-items: center; justify-content: center;">
        <div class="modal-content" style="background: white; margin: auto; padding: 2rem; border-radius: 12px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto; box-shadow: 0 8px 32px rgba(0,0,0,0.2);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; border-bottom: 2px solid var(--border); padding-bottom: 1rem;">
                <h2 id="applicationModalTitle" style="margin: 0; color: var(--text);">Apply for Position</h2>
                <span class="close" onclick="closeApplicationModal()" style="font-size: 2rem; cursor: pointer; color: var(--text-light); transition: color 0.2s ease;" onmouseover="this.style.color='var(--text)'" onmouseout="this.style.color='var(--text-light)'">&times;</span>
            </div>
            
            <form id="applicationForm" style="display: flex; flex-direction: column; gap: 1.5rem;">
                <!-- Personal Information -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div>
                        <label for="firstName" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">First Name *</label>
                        <input type="text" id="firstName" name="firstName" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border); border-radius: 6px; font-size: 1rem;">
                    </div>
                    <div>
                        <label for="lastName" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">Last Name *</label>
                        <input type="text" id="lastName" name="lastName" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border); border-radius: 6px; font-size: 1rem;">
                    </div>
                </div>
                
                <div>
                    <label for="email" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">Email Address *</label>
                    <input type="email" id="email" name="email" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border); border-radius: 6px; font-size: 1rem;">
                </div>
                
                <div>
                    <label for="phone" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">Phone Number</label>
                    <input type="tel" id="phone" name="phone" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border); border-radius: 6px; font-size: 1rem;">
                </div>
                
                <!-- Cover Letter Options -->
                <div>
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">Cover Letter *</label>
                    <div style="margin-bottom: 1rem;">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="radio" name="coverLetterType" value="text" checked style="margin: 0;">
                            <span>Write cover letter</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; margin-top: 0.5rem;">
                            <input type="radio" name="coverLetterType" value="file" style="margin: 0;">
                            <span>Upload file</span>
                        </label>
                    </div>
                    
                    <div id="coverLetterTextGroup">
                        <textarea id="coverLetterText" name="coverLetterText" placeholder="Tell us why you're interested in this role and what you'd bring to our team..." required style="width: 100%; min-height: 120px; padding: 0.75rem; border: 2px solid var(--border); border-radius: 6px; font-size: 1rem; resize: vertical;"></textarea>
                    </div>
                    
                    <div id="coverLetterFileGroup" style="display: none;">
                        <input type="file" id="coverLetterFile" name="coverLetterFile" accept=".pdf,.doc,.docx,.txt" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border); border-radius: 6px; font-size: 1rem;">
                        <small style="color: var(--text-light); margin-top: 0.5rem; display: block;">Accepted formats: PDF, DOC, DOCX, TXT (max 5MB)</small>
                    </div>
                </div>
                
                <!-- Availability -->
                <div>
                    <label for="availability" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">When are you available to start?</label>
                    <select id="availability" name="availability" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border); border-radius: 6px; font-size: 1rem;">
                        <option value="">Select availability</option>
                        <option value="immediately">Immediately</option>
                        <option value="1-2weeks">1-2 weeks</option>
                        <option value="1month">Within 1 month</option>
                        <option value="flexible">Flexible</option>
                    </select>
                </div>
                
                <!-- Experience -->
                <div>
                    <label for="experience" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">Relevant Experience (Optional)</label>
                    <textarea id="experience" name="experience" placeholder="Tell us about any relevant experience, skills, or qualifications..." style="width: 100%; min-height: 80px; padding: 0.75rem; border: 2px solid var(--border); border-radius: 6px; font-size: 1rem; resize: vertical;"></textarea>
                </div>
                
                <!-- Privacy Notice -->
                <div style="background: rgba(248,249,250,0.9); padding: 1rem; border-radius: 6px; border-left: 4px solid var(--primary);">
                    <small style="color: var(--text-light); line-height: 1.4;">
                        <strong>Privacy Notice:</strong> Your application will be securely processed by CT5 Pride. We only use your information for volunteer recruitment purposes and will not share it with third parties. See our <a href="privacy.html" style="color: var(--primary);">Privacy Policy</a> for more details.
                    </small>
                </div>
                
                <!-- Submit Button -->
                <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 1rem;">
                    <button type="button" onclick="closeApplicationModal()" style="padding: 0.75rem 1.5rem; background: transparent; border: 2px solid var(--border); border-radius: 6px; cursor: pointer; font-size: 1rem;">Cancel</button>
                    <button type="submit" style="padding: 0.75rem 2rem; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1rem; font-weight: 600;">Submit Application</button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/main.js"></script>
</body>
</html> 